<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin - Manage Internships</title>
  <style>
    body { font-family: Arial, sans-serif; background:#F5F5FA; color:#1A2A80; margin:0; }
    header { background:#1A2A80; color:#fff; padding:15px; text-align:center; }
    .container { max-width:800px; margin:20px auto; padding:20px; background:#fff; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1); }
    h2 { text-align:center; }
    form { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
    input, textarea { padding:8px; border:1px solid #ccc; border-radius:6px; }
    button { padding:10px; border:none; border-radius:6px; background:#3B38A0; color:white; cursor:pointer; font-weight:bold; }
    button:hover { background:#1A2A80; }
    .card { background:#f9f9f9; padding:12px; margin:10px 0; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,0.1); }
    .card h3 { margin:0; }
    .card button { margin-right:10px; background:#E63946; }
    .card button.update { background:#2A9D8F; }
  </style>
</head>
<body>
<header><h1>Admin - Internship Management</h1></header>
<div class="container">
  <h2>Add Internship</h2>
  <form id="internshipForm">
    <input type="text" id="title" placeholder="Internship Title" required>
    <input type="text" id="company" placeholder="Company Name" required>
    <textarea id="description" placeholder="Description" required></textarea>
    <input type="date" id="date" required>
    <input type="time" id="time" required>
    <input type="text" id="location" placeholder="Location" required>
    <input type="url" id="link" placeholder="Application Link" required>
    <button type="submit">Add Internship</button>
  </form>

  <h2>Manage Internships</h2>
  <div id="internshipList"></div>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCBfr5gR5pihZoSTvId8E5Ty_5RCL5MYhw",
    authDomain: "auth-demo-37f58.firebaseapp.com",
    projectId: "auth-demo-37f58",
    storageBucket: "auth-demo-37f58.appspot.com",
    messagingSenderId: "799076361553",
    appId: "1:799076361553:web:6ff356a4d894a27cfb9f70"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const auth = getAuth(app);

  const adminUID = "4fNzKdtwSBVXbnvxilAvgIuarA73"; // replace with actual Admin UID

  const internshipForm = document.getElementById("internshipForm");
  const internshipList = document.getElementById("internshipList");

  // Add Internship
  internshipForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const title = document.getElementById("title").value;
    const company = document.getElementById("company").value;
    const description = document.getElementById("description").value;
    const date = document.getElementById("date").value;
    const time = document.getElementById("time").value;
    const location = document.getElementById("location").value;
    const link = document.getElementById("link").value;

    await addDoc(collection(db,"internships"), {
      title, company, description, date, time, location, link,
      createdAt: new Date().toISOString()
    });

    internshipForm.reset();
    loadInternships();
  });

  // Load internships
  async function loadInternships() {
    internshipList.innerHTML = "";
    const snapshot = await getDocs(collection(db,"internships"));
    snapshot.forEach(docSnap => {
      const data = docSnap.data();
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <h3>${data.title || "No Title"} @ ${data.company || "Unknown Company"}</h3>
        <p>${data.description || ""}</p>
        <p><b>Date:</b> ${data.date || "N/A"} <b>Time:</b> ${data.time || "N/A"}</p>
        <p><b>Location:</b> ${data.location || "N/A"}</p>
        <a href="${data.link || "#"}" target="_blank">Application Link</a><br><br>
        <button class="update">Update</button>
        <button class="delete">Delete</button>
      `;

      // Delete
      div.querySelector(".delete").addEventListener("click", async () => {
        await deleteDoc(doc(db,"internships",docSnap.id));
        loadInternships();
      });

      // Update
      div.querySelector(".update").addEventListener("click", async () => {
        const newTitle = prompt("Update title:", data.title);
        const newCompany = prompt("Update company:", data.company);
        const newDesc = prompt("Update description:", data.description);
        const newDate = prompt("Update date (YYYY-MM-DD):", data.date);
        const newTime = prompt("Update time (HH:MM):", data.time);
        const newLocation = prompt("Update location:", data.location);
        const newLink = prompt("Update link:", data.link);

        await updateDoc(doc(db,"internships",docSnap.id), {
          title:newTitle, company:newCompany, description:newDesc,
          date:newDate, time:newTime, location:newLocation, link:newLink
        });
        loadInternships();
      });

      internshipList.appendChild(div);
    });
  }

  // Auth Check
  onAuthStateChanged(auth,(user)=>{
    if(user && user.uid===adminUID){
      loadInternships();
    } else {
      document.body.innerHTML = "<h2 style='text-align:center;color:red;'>Access Denied</h2>";
    }
  });
</script>
</body>
</html>
