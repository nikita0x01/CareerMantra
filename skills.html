<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Skills Tracker - CareerMantra</title>
  <style>
    body { font-family: Arial, sans-serif; background: #F5F5FA; color: #1A2A80; margin: 0; }
    header { background: #1A2A80; color: #fff; padding: 15px; text-align: center; }
    .section { max-width: 900px; margin: auto; padding: 20px; }
    h2 { text-align:center; }
    #skillForm { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 20px; }
    input, select { padding: 10px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; }
    button { padding: 10px 20px; background: #3B38A0; color: #fff; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; }
    button:hover { background: #1A2A80; }
    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .card { background: #B2B0E8; padding: 15px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; }
    .card h3 { margin-top: 0; color: #3B38A0; }
    .card p { margin: 5px 0; }
    .progress-bar { width: 100%; background: #ddd; border-radius: 6px; overflow: hidden; margin-top: 5px; }
    .progress-fill { height: 12px; background: #3B38A0; width: 0%; border-radius: 6px; transition: width 0.5s ease; }
    .card button { position: absolute; top: 10px; right: 10px; background: #FF4C4C; }
  </style>
</head>
<body>
<header>
  <h1>Skills Tracker</h1>
</header>

<section class="section">
  <h2>Track Your Skills</h2>
  <form id="skillForm">
    <input type="text" id="skillName" placeholder="Skill Name" required>
    <select id="skillLevel">
      <option value="Beginner">Beginner</option>
      <option value="Intermediate">Intermediate</option>
      <option value="Advanced">Advanced</option>
    </select>
    <select id="skillCategory">
      <option value="Analytical">Analytical</option>
      <option value="Creative">Creative</option>
      <option value="Introvert">Introvert</option>
      <option value="Extrovert">Extrovert</option>
    </select>
    <button type="button" onclick="addSkill()">Add Skill</button>
  </form>

  <div id="skillCards" class="cards"></div>
</section>

<!-- Firebase SDKs -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ðŸ”¥ Your Firebase Config
  const firebaseConfig = {
      apiKey: "AIzaSyCBfr5gR5pihZoSTvId8E5Ty_5RCL5MYhw",
      authDomain: "auth-demo-37f58.firebaseapp.com",
      projectId: "auth-demo-37f58",
      storageBucket: "auth-demo-37f58.firebasestorage.app",
      messagingSenderId: "799076361553",
      appId: "1:799076361553:web:6ff356a4d894a27cfb9f70",
      measurementId: "G-RPZBW0SCK5"
    };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const skillCardsDiv = document.getElementById("skillCards");
  const skillForm = document.getElementById("skillForm");

  let currentUser = null;

  // Render skills from Firebase
  async function renderSkills() {
    if (!currentUser) return;

    skillCardsDiv.innerHTML = "<p>Loading skills...</p>";

    const skillsRef = collection(db, "users", currentUser.uid, "skills");
    const querySnapshot = await getDocs(skillsRef);

    if (querySnapshot.empty) {
      skillCardsDiv.innerHTML = "<p style='text-align:center;'>No skills added yet!</p>";
      return;
    }

    skillCardsDiv.innerHTML = "";
    querySnapshot.forEach((docSnap) => {
      const skill = docSnap.data();
      const progress = skill.level === "Beginner" ? 30 :
                       skill.level === "Intermediate" ? 60 : 100;

      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h3>${skill.name} (${skill.category})</h3>
        <p>Level: ${skill.level}</p>
        <div class="progress-bar"><div class="progress-fill" style="width:${progress}%"></div></div>
        <button onclick="deleteSkill('${docSnap.id}')">Delete</button>
      `;
      skillCardsDiv.appendChild(card);
    });
  }

  // Add skill
  async function addSkill() {
    if (!currentUser) { alert("Please login first!"); return; }

    const name = document.getElementById("skillName").value.trim();
    const level = document.getElementById("skillLevel").value;
    const category = document.getElementById("skillCategory").value;

    if (!name) { alert("Enter skill name"); return; }

    const skillsRef = collection(db, "users", currentUser.uid, "skills");
    await addDoc(skillsRef, { name, level, category });

    skillForm.reset();
    renderSkills();
  }
  window.addSkill = addSkill;

  // Delete skill
  async function deleteSkill(skillId) {
    if (!currentUser) return;
    if (confirm("Delete this skill?")) {
      await deleteDoc(doc(db, "users", currentUser.uid, "skills", skillId));
      renderSkills();
    }
  }
  window.deleteSkill = deleteSkill;

  // Watch login state
  onAuthStateChanged(auth, (user) => {
    if (user) {
      currentUser = user;
      renderSkills();
    } else {
      currentUser = null;
      skillCardsDiv.innerHTML = "<p style='text-align:center;'>Login to manage your skills.</p>";
    }
  });
</script>
</body>
</html>
